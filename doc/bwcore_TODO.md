# bwcore1.5

## 目标

全部重构bwcore1.3(impbwcore)代码。

bwcore1.5(strongbwcore)对目前成熟的技术进行实验和调优。主要目标为快速终局搜索、快速位运算估值、pvs搜索、置换表等。实验性的内容之后考虑。

## 辅助文件

* boardhex.html 用于产生和查看棋盘的十六进制码。

## 棋盘数据结构

位运算棋盘操作board.cpp，封装常用操作。

包含以下操作：

生成可行位置、位运算棋步、对称变换、计数。

### 可行位置生成

使用Zebra代码。使用纯位运算消除分支语句，并用分支技巧把8次位运算降低到3次。

### 位运算棋步

使用BMI2指令黑魔法进行快速翻转。

把四个方向的翻转的每一条线，使用PEXT提取映射成一条线。这条线上的翻转可以构造查表。再PDEP放回。

1. 需要有pos映射后的翻转位置(0..63)=>(0..7)。该值为4*64个常数，直接打表查询。
2. 需要pos在各个位置上的mask。
3. 主查询表为在一条线上的翻转，有8*65536种状态，映射为2字节。耗内存1MB。